#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
//  -123.5 + 4 - 456+56
int main() 
{ 	char prim[90];
	char prob[10]=" ";
	char min[10]="-";
	char plus[10]="+";
	char *res;
	int flag;
	double result;
	result=0;
	printf("Enter an example: \n");
	fgets(prim, 90, stdin);
	res = strtok(prim,prob);
	while (res!=NULL)
	{ 
		if (strcmp(res, "+") == 0)
		{
			flag = 1;
		}
		if (strcmp(res, "-") == 0)
		{
			flag = 2;
		}
		if (isdigit(*res))
        {
            if (flag == 1)
            {
                result += atof(res);
                
            }
            if (flag == 2)
            {
                result -= atof(res);
            }
        }
        if (!isdigit(*res) && (strcmp(res, "+")!=0) && (strcmp(res, "-")!=0))
        {
        	res = strtok(prim,min);
        	while(res!=NULL)
        	{	
        	if (isdigit(*res))
        	{
        		printf("%s", res);
			}
        	res = strtok(prim, min);
        	}
        	res = strtok(prim,plus);
        	while(res!=NULL)
        	{	
        	if (isdigit(*res))
        	{
        		result += atof(res);
			}
        	res = strtok(prim, plus);
        	}
        }
        res = strtok(NULL, prob);
    }
    printf("Result is: %.2f", result);
    return 0; 
}
исправленное
//




#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
//  -123.5 + 4 - 456+56
int main() 
{ 	char prim[90];
	char prob[10]=" ";
	char min[10]="-";
	char plus[10]="+";
	char *res, *res1, *res2;
	int flag;
	double result;
	result=0;
	printf("Enter an example: \n");
	fgets(prim, 90, stdin);
	res = strtok(prim,prob);
	while (res!=NULL)
	{ 
		if (strcmp(res, "+") == 0)
		{
			flag = 1;
		}
		if (strcmp(res, "-") == 0)
		{
			flag = 2;
		}
		if (isdigit(*res) || !isdigit(*res) && (strcmp(res, "+")!=0) && (strcmp(res, "-")!=0))
        {	
			res1 = strtok(res,min);
            while(res1!=NULL)
            {	
	        	if (isdigit(*res1))
	        	{
	        		if (flag == 0 || flag ==1)
	        		{
						result -= atof(res1);
					}
					if (flag == 2)
	        		{
						result += atof(res1);
					}
				}
			res1 = strtok(NULL,min);
			}
        	res2 = strtok(res,plus);
			while (res2!=NULL)
			{
	        	if (isdigit(*res2))
	        	{
	        		if (flag == 0 || flag ==1)
	        		{
						result += atof(res2);
					}
					if (flag == 2)
	        		{
						result -= atof(res2);
					}
	            }
            res2 = strtok(NULL,plus);
        	}
           
        }
        res = strtok(NULL, prob);
    }
    printf("Result is: %.1f", result);
    return 0; 
}
